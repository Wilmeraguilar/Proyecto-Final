<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <meta name="description" content="Página de ejemplo de Spring Boot + Thymeleaf para el curso de Egg Educación"/>
    <meta name="author" content="Fernando Cocco"/>
    <title th:text="|${title} - Biblioteca EGG|"></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark bg-dark sticky-top">
    <div class="container-fluid">
        <a class="navbar-brand" th:href="@{/}">Inicio</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div id="navbarSupportedContent" class="collapse navbar-collapse">
            <ul class="navbar-nav mb-2 mb-md-0 w-100">
                <!--DROPDOWN USUARIOS-->
                <li class="nav-item dropdown">
                    <a id="dropdown-libros" class="nav-link dropdown-toggle" href="#" role="button"
                       data-bs-toggle="dropdown" aria-expanded="false">Usuarios</a>

                    <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="dropdown-libros">
                        <li >
                            <a class="dropdown-item" th:href="@{/usuariosPrueba}">Mostrar usuarios</a>
                        </li>
                        <li >
                            <a class="dropdown-item" th:href="@{/usuariosPrueba/crear}">Crear usuario</a>
                        </li>
                    </ul>
                </li>
                <!--DROPDOWN ROLES-->
                <li class="nav-item dropdown">
                    <a id="dropdown-autores" class="nav-link dropdown-toggle" href="#" role="button"
                       data-bs-toggle="dropdown" aria-expanded="false">Roles</a>

                    <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="dropdown-autores">
                        <li ><a class="dropdown-item" th:href="@{/roles}">Mostrar roles</a></li>
                        <li >
                            <a class="dropdown-item" th:href="@{/roles/crear}">Crear Rol</a>
                        </li>
                    </ul>
                </li>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container mt-5 main">
    <h1 th:text="${title}"></h1>
    <hr class="mb-5 col-xl-12"/>
    <form id="formulario" class="needs-validation" th:action="@{/usuariosPrueba/__${action}__}" method="POST"
          th:object="${usuario}" autocomplete="off" novalidate>
        <!-- <input type="hidden" th:field="*{username}"/> -->

        <div class="form-floating mb-3 col-xl-6">
            <input id="username" class="form-control" type="text" placeholder="Nombre Usuario " th:field="*{username}" required 
            th:readonly="${usuario.username != null}"/>
            <label for="username">Nombre de usuario</label>
            <div class="invalid-feedback">El nombre del usuario es obligatorio</div>
        </div>
        <div class="form-floating mb-3 col-xl-6">
            <input id="pass" class="form-control" type="password" placeholder="clave" th:field="*{pass}" required/>
            <label for="pass">Clave</label>
            <div class="invalid-feedback">La clave es obligatoria</div>
        </div>
<!-- 
        <select id="provincias">
            <option value="" disabled selected>Elegi provincia</option>
            <option value="mendoza">Mendoza</option>
            <option value="buenos aires">Buenos Aires</option>
            <option value="san juan">San Juan</option>
        </select>
        
        <select id="municipios">
            <option value="" disabled selected>Elegi municipio</option>
        </select>
 -->


        <div class="form-floating mb-3 col-xl-6 mt-3">
            <select  class="form-select"  aria-label="Elegir Horario" th:field="*{horario}" required>
                <option value="" disabled selected>Elegir horario</option>
               
            <option value="">08:00</option>
                <option value="">09:00</option>
                <option value="">10:00</option>
                <option value="">11:00</option>
                <option value="">12:00</option>
                <option value="">13:00</option>
                <option value="">14:00</option>
                <option value="">15:00</option>
                <option value="">16:00</option>
                <option value="">17:00</option>
                <option value="">18:00</option>
                <option value="">19:00</option>
                <option value="">20:00</option>
                <option value="">21:00</option>
                <option value="">22:00</option>
              <!--   <option value="Salta">Salta</option>
                <option value="San Juan">San Juan</option>
                <option value="San Luis">San Luis</option>
                <option value="santa cruz">Santa Cruz</option>
                <option value="Santa Fe">Santa Fe</option>
                <option value="Santiago del Estero">Santiago del Estero</option>
                <option value="Tierra del Fuego">Tierra del Fuego</option>
                <option value="Tucuman">Tucumán</option> -->
               
            </select>
            <label for="Horario">Horario</label>
            <div class="invalid-feedback">El horario es obligatorio</div>
        </div>

        <div class="form-floating mb-3 col-xl-6 mt-3">
            <select id="provincias" class="form-select"  aria-label="Elegir Provincia" th:field="*{provincia}" required>
                <option value="" disabled selected>Elegir provincia</option>
            </select>
            <label for="Provincia">Provincia</label>
            <div class="invalid-feedback">La provincia es obligatoria</div>
        </div>

        <div class="form-floating mb-3 col-xl-6 mt-3">
            <select id="municipios" class="form-select"  aria-label="Elegir Ciudad" th:field="*{ciudad}" required>
                <option value="" disabled selected>Elegir Ciudad</option>
               
            </select>
            <label for="Ciudad">Ciudad</label>
            <div class="invalid-feedback">La ciudad es obligatoria</div>
        </div>





        <div class="form-floating mb-3 col-xl-6 mt-3">
            <select id="rol" class="form-select"  aria-label="Elegir Rol" th:field="*{rol}" required>
                <option value="" selected>Elegir Rol</option>
                <option th:each="rol : ${roles}" th:text="${rol.nombre}"
                        th:value="${rol.id}"></option>
            </select>
            <label for="Rol">Rol</label>
            <div class="invalid-feedback">El rol es obligatorio</div>
        </div>
        
        <div class="row">
            <div class="col-xl-3">
                <button class="btn btn-success" type="submit"
                        th:text="${action == 'guardar'} ? 'Crear Usuario' : 'Guardar cambios'"></button>
            </div>
        </div>
    </form>
</div>

<footer class="footer py-3 bg-dark fixed-bottom">
    <div class="container d-flex justify-content-center">
        <span class="text-muted">&copy; Ezequiel Olivera - 2021</span>
        <a class="text-decoration-none ms-3 footer-link" href=""
           target="_blank">
            <i class="bi bi-linkedin"></i>
        </a>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
        crossorigin="anonymous"></script>
<script>
    (() => {
        "use strict";

        const form = document.getElementById("formulario");
        form.addEventListener("submit", (event) => {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }

            form.classList.add("was-validated");
        }, false)
    })();
</script>
<!-- <script>
    const selectMunicipios = document.getElementById("municipios");
    const provincias = document.getElementById("provincias");

    // buscarProvincias(provincias.value);

    provincias.addEventListener("change", () => buscarProvincias(provincias.value));

    async function buscar(provincia) {
        const url = `https://apis.datos.gob.ar/georef/api/municipios?provincia=${provincia}&campos=nombre&max=200`;
        const response = await fetch(url);
        return response.json();
    }

    function buscarProvincias(provincia) {
        selectMunicipios.innerHTML = "";

        buscar(provincia).then(data => {
            for (const municipio of data["municipios"]) {
                const option = document.createElement("option");
                option.value = municipio["nombre"];
                option.innerText = municipio["nombre"];
                selectMunicipios.appendChild(option);
            }
        });
    }
</script> -->
<script>
    const selectMunicipios = document.getElementById("municipios");
    const provincias = document.getElementById("provincias");

    provincias.addEventListener("change", () => buscarMunicipios(provincias.value));

    async function buscar(provincia) {
        const url = `https://apis.datos.gob.ar/georef/api/municipios?provincia=${provincia}&campos=nombre&max=200&orden=nombre`;
        const response = await fetch(url);
        return response.json();
    }

    function buscarMunicipios(provincia) {
        selectMunicipios.innerHTML = "";

        buscar(provincia).then(data => {
            for (const municipio of data["municipios"]) {
                const option = document.createElement("option");
                option.value = municipio["nombre"];
                option.innerText = municipio["nombre"];
                selectMunicipios.appendChild(option);
            }
        });
    }

    (() => {
        const buscar = async () => {
            const url = "https://apis.datos.gob.ar/georef/api/provincias?campos=nombre&orden=nombre";
            const response = await fetch(url);
            return response.json();
        };

        buscar().then(data => {
            for (const provincia of data["provincias"]) {
                const option = document.createElement("option");
                option.value = provincia["nombre"];
                option.innerText = provincia["nombre"];
                provincias.appendChild(option);
            }
        })
    })();
</script>
</body>
</html>
